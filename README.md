# komtet-kassa-umi-cms

Модуль КОМТЕТ Кассы для UMI CMS

Данное решение позволяет подключить Ваш интернет-магазин к облачному сервису КОМТЕТ Касса с целью соответствия требованиям 54-ФЗ для регистрации расчетов с использованием электронного средства платежа в сети Интернет.

### Версия
1.0.0

### Возможности модуля
  - автоматическая фискализация платежей при оплате заказа клиентом,
  - автоматическая фискализация платежей при смене статуса заказа менеджером.

### Описание работы
Модуль реагирует событие когда клиент совершает оплату через один из подключенных модулей приема платежей (PayPal, Robokassa) либо менеджер магазина меняет статус оплаты заказа на "принята" либо на "отказ", и направляет данные о заказе в систему КОМТЕТ Касса.

Как только данные по заказу появляются в системе КОМТЕТ Касса, формируется чек, который записывается на фискальный накопитель кассового аппарата и он же отправляется в ОФД (Оператор Фискальных Данных). Если указано в настройках, аппарат может распечатать бланк чека.

Важно! 54-ФЗ обязует выдать электронный чек клиенту, для того чтобы электронный чек был выслан клиенту на электронную почту необходимо сделать обязательным поле email на форме оформления заказа.

### Установка
- скопируйте папку "/classes/components/komtet_kassa" в папку "ваша_папка_с_umi_cms/classes/components/".
- в администраторской части сайта в левом меню выберите пункт "Модули", далее подпункт "Конфигурация", на открывшейся странице откройте вкладку "Модули"
- в нижней части страницы в поле "Путь до инсталляционного файла" укажите получившийся путь к модулю КОМТЕТ Кассы, а именно "classes/components/komtet_kassa/install.php"
- нажмите кнопку "Установить"


### Настройка модуля

Прежде чем приступить к настройке модуля, вам потребуется зарегистрироваться в [личном кабинете на сайте КОМТЕТ Касса](https://kassa.komtet.ru/signup).
Чтобы зайти в настройки, нажмите на название модуля в списке установленных модулей.
В настройках модуля необходимо указать:
1. ID Магазина. В личном кабинете на сайте КОМТЕТ Касса зайдите в меню «Магазины» (слева в выпадающем меню "Фискализация"), далее выберете нужный магазин и зайдите в его настройки, там вы и найдете необходимое значение (ShopId).
2. Secret Магазина. Аналогично предыдущему (Secret).
2. ID Очереди. В личном кабинете на сайте КОМТЕТ Касса зайдите в меню «Кассы» (слева в выпадающем меню "Фискализация"), далее найдите нужный магазин и слева от его названия вы найдете четырехзначное число (ID очереди).
4. Включить или отключить печать бумажного чека.
5. Указать систему налогообложения вашей компании. Данные о системе налогообложения будут использованы при формировании чека.
6. Указать налоговую ставку товаров. Данные о налоговой ставке будут использованы при формировании чека.
